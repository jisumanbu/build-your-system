---
description: "[Organize] 时间线视图 - 混合展示手动记录与自动追踪"
argument-hint: "[YYYY-MM-DD]"
---

展示指定日期的时间线，混合显示手动间隙记录和 Claude Code 活动数据。

**$ARGUMENTS**

- 如果提供日期参数，显示该日期的时间线
- 如果不提供，显示今天的时间线

## 执行流程

### 0. 检查初始化状态

先检查 `60-Memory/profile.md` 是否存在。如果不存在，提示用户先运行 `/a-setup` 完成初始化。

### 1. 确定日期

- 如果有 $ARGUMENTS，解析为日期
- 否则使用当前日期（GMT+8）

### 2. 收集数据源

#### 2a. 手动间隙记录

读取 `00-Inbox/{YYYY-MM-DD}.md` 文件：
- 查找 `## 间隙日志` 区块
- 解析每个 `### {HH:MM}` 条目
- 提取：时间、完成、感受、下一步、备注

#### 2b. Claude Code 活动数据

运行 Python 脚本获取活动数据：

!`python3 "${CLAUDE_PLUGIN_ROOT}/scripts/analyze-cc-activity.py" $ARGUMENTS --json-only 2>/dev/null || echo "{}"`

解析 JSON 输出，提取：
- 会话开始时间
- 会话名称
- 活动摘要
- 消息数量

### 3. 合并与排序

将两种数据源按时间戳合并：
- 📝 = 手动间隙记录（来自 /c-pause 或 #pause 捕获）
- 💻 = Claude Code 活动（自动追踪）

按时间升序排列。

### 4. 计算时间间隔

计算相邻事件之间的时间间隔，标注为：
- 深度工作时间（上一事件是 🎯 专注或 💻 活动）
- 休息/间隔时间（上一事件是任务完成或分心恢复）
- 分心时间（上一事件是 📱 分心）

### 5. 统计汇总

#### 从间隙记录统计
- 😊 顺利次数
- 😔 卡住次数
- 🎯 专注次数
- 📱 分心次数

#### 从 CC 活动统计
- 总会话数
- 总活动时间
- 各领域分布

#### 综合统计
- 深度工作总时长
- 分心总时长
- 休息/间隔总时长

### 6. MIT 关联

读取 `50-GTD/active.md` 中该日期的 MIT：
- 提取 `## 今日重点 (MIT)` 区块
- 显示 MIT 完成状态

### 7. 输出时间线

```
📅 {YYYY-MM-DD} 时间线
═══════════════════════════════════════

{时间} {图标} {事件描述} {感受emoji，如果有}
      ↓ {时间间隔类型} {分钟数} 分钟
{时间} {图标} {事件描述} {感受emoji，如果有}
      ↓ {时间间隔类型} {分钟数} 分钟
...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 今日统计
🎯 深度工作: {时长} | 📱 分心: {时长} | ☕ 休息: {时长}
💻 CC 会话: {数量} | 📝 间隙记录: {数量}
✅ MIT 完成: {已完成}/{总数}

🔍 情绪分布
😊 顺利: {次数} | 😐 一般: {次数} | 😔 卡住: {次数}
🎯 专注: {次数} | 📱 分心: {次数}
```

## 输出示例

```
📅 2026-01-14 时间线
═══════════════════════════════════════

09:15 💻 Claude Code 会话: 文章写作
09:18 📝 开始深度工作 - 准备写文章 😊
      ↓ 深度工作 46 分钟
10:04 📝 完成初稿，比预期快30分钟 🎯
      ↓ 休息 42 分钟
10:46 📝 分心了 - Twitter 黑洞 📱
      ↓ 分心 22 分钟
11:08 📝 回归工作，准备开会 😐
11:30 💻 Claude Code 会话: 会议准备
      ↓ 活动 45 分钟
12:15 📝 会议结束，午餐时间 😊
      ↓ 休息 1 小时 15 分钟
13:30 💻 Claude Code 会话: 代码审查
14:00 📝 完成代码审查，感觉高效 🎯

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 今日统计
🎯 深度工作: 2h 31m | 📱 分心: 22m | ☕ 休息: 1h 57m
💻 CC 会话: 3 | 📝 间隙记录: 6
✅ MIT 完成: 2/3

🔍 情绪分布
😊 顺利: 3 | 😐 一般: 1 | 😔 卡住: 0
🎯 专注: 2 | 📱 分心: 1
```

## 空数据处理

如果当天没有任何记录：

```
📅 {YYYY-MM-DD} 时间线
═══════════════════════════════════════

暂无记录

💡 提示：
- 使用 /c-pause 记录间隙日志
- 或使用 /c-capture 快速捕获（会自动识别间隙模式）
```

## 重要规则

1. **时间显示使用 GMT+8**
2. **分层显示**：手动记录（📝）和自动追踪（💻）清晰区分
3. **时间间隔计算**：基于相邻事件的时间差
4. **容错处理**：cc-activity.py 失败时仍显示手动记录
5. **当前目录就是 Vault**，使用相对路径

## 与其他命令的关系

- `/c-pause` - 创建间隙记录
- `/c-capture` - 智能识别间隙模式
- `/o-review` - 在复盘 Phase 2 时调用本命令
- `/cc-activity` - 底层活动分析脚本
